// Place all the behaviors and hooks related to the matching controller here.
// All this logic will automatically be available in application.js.
<%# Todo: Get the actual value of the host id here %>
<% host_id = 1 %>

$(document).ready(function(){
  var firebaseUrl = 'https://urbanzeak.firebaseio.com/' + <%= host_id %> + '/';
  var hostChatRef = new Firebase(firebaseUrl);

  $('#chatMessage').keypress(function(e){
    if (e.keyCode == 13){
        var name = $('#chatName').val();
        var message = $('#chatMessage').val();
      hostChatRef.push({name:name, message: message})
    }
  });

  hostChatRef.limit(10).on('child_added', function(snapshot){
    var message = snapshot.val();
    $('<div/>').text(message.message).prepend($('<em/>')
        .text(message.name+': ')).appendTo($('#chatText'));
    $('#chatText')[0].scrollTop = $('#chatText')[0].scrollHeight;
  });

});