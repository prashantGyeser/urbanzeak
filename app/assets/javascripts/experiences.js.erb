<%# Todo: Get the actual value of the host id here %>
<% host_id = 1 %>

// Generating a random string for the user
function makeid()
{
  var text = "";
  var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

  for( var i=0; i < 5; i++ )
    text += possible.charAt(Math.floor(Math.random() * possible.length));

  return text;
}

// Live chat
alert("It is getting here");
var firebaseUrl = 'https://urbanzeak.firebaseio.com/' + <%= host_id %> + '/';
var presenceUrl = 'https://urbanzeak.firebaseio.com/' + <%= host_id %> + '/customers/';

var hostChatRef = new Firebase(firebaseUrl);
var presenceRef = new Firebase(presenceUrl);
var currentUserRandomId = makeid();

presenceRef.push({autoGeneratedUserId: currentUserRandomId});

$('#chatMessage').keypress(function(e){
  if (e.keyCode == 13){
    var name = 'John' //$('#chatName').val();
    var message = $('#message').val();
    //hostChatRef.push({name:name{message: message}})
  }
});

hostChatRef.limit(10).on('child_added', function(snapshot){
  var message = snapshot.val();
  $('<div/>').text(message.message).prepend($('<em/>')
          .text(message.name+': ')).appendTo($('#chatText'));
  $('#chatText')[0].scrollTop = $('#chatText')[0].scrollHeight;
});




$(document).ready(function(){
    //$('#newExperienceModal').modal('show');
    /*
    $("#map").gmap3({
        map:{
            options:{
                center:[22.49156846196823, 89.75802349999992],
                zoom:10,
                mapTypeId: google.maps.MapTypeId.ROADMAP,
                mapTypeControl: true,
                mapTypeControlOptions: {
                    style: google.maps.MapTypeControlStyle.DROPDOWN_MENU
                },
                navigationControl: true,
                scrollwheel: true,
                streetViewControl: true
            },
            events:{
                click: function(event, data){
                    // Getting the latitude and longitude for the location clicked on the map
                    console.log("The event is:", data.latLng);
                    //var latitude = $("#map").gmap3(marker.value);
                    $('#experience_latitude').val(data.latLng.lat());
                    $('#experience_longitude').val(data.latLng.lng());
                    $(this).gmap3({
                        clear: "marker",
                        marker: {
                            latLng: data.latLng
                        }
                    });
                }
            }

        }
    });
    */
  // Chat modal
  $(".fancybox").fancybox({
    'autoSize': false,
    'padding': [0,0,0,0],
    'width': 800,
    'height': 400
  });



});


