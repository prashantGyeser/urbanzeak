$(document).ready(function(){$("#overlay").click(function(){$("#overlay").remove()}),$("#available_date").hide(),$("#top-nav").singlePageNav(),$("#review_created_success").hide(),$("#conversation_created_success").hide(),$("#conversation_created_fail").hide(),$("#message_field_blank").hide(),$("#invalid_email").hide(),$("#create_review").click(function(e){e.preventDefault(),$.post("/experiences/create_review",$("form#new_review").serialize(),function(){$(".modal-body").hide(),$("#review_created_success").show(),$("#create_review").attr("disabled",!0),$("#create_review").addClass("disabled")},"json")}),$("#send_conversation").validate(),$("#send_conversation").click(function(e){e.preventDefault();var a=$("#message_email").val(),i=$("#message_body").val();if(0==a.length||0==i.length)return $("#message_field_blank").show(),!1;var t=a.indexOf("@"),n=a.lastIndexOf(".");return 1>t||t+2>n||n+2>=a.length?($("#conversation_created_fail").hide(),$("#message_field_blank").hide(),$("#conversation_created_success").hide(),$("#invalid_email").show(),!1):($("#invalid_email").hide(),void $.post("/conversations/create",$("form#new_conversation").serialize()).done(function(){$("#conversation_created_fail").hide(),$("#message_field_blank").hide(),$(".new_conversation_body").hide(),$("#conversation_created_success").show(),$("#send_conversation").attr("disabled",!0),$("#send_conversation").addClass("disabled")}).fail(function(){$("#conversation_created_fail").show(),$("#message_field_blank").hide(),$("#conversation_created_success").hide()}))}),$("#get_dates").click(function(e){e.preventDefault();var a=$("#attendee_seats").val(),i=$("#experience_id").val(),t="/experiences/available_dates?seats_required="+a+"&experience_id="+i;$("#join-notifications").show(),$.get(t,function(e){$(".result").html(e),console.log("The data returend from the server is:",e);var a=e;$("#attending_date").datepicker("remove"),console.log($("form#new_review").serialize()),$("#attending_date").datepicker({beforeShowDay:function(e){return-1==$.inArray($.datepicker.formatDate("yy-mm-dd",e),a)?{enabled:!1}:void 0}}).on("changeDate",function(e){var a=$.datepicker.formatDate("dd-mm-yy",e.date);$("#attendee_attending_date").val(a)}).on("show",function(){$("#join-notifications").hide(),$("#available_date").show(),$("#first_available_date").text(a[0])})})}),$(".date_select").click(function(){$(this).addClass("disabled")}),$("#attendee_seats").change(function(){var e=$(this).val(),a=$("#new_attendee input[type=radio]:checked").siblings(".text-info").children(".available_seats").text();if($(this).css("border",""),$("label.error").remove(),e>parseInt(a)){$(this).css("border","1px solid #f35958");var i='<label for="attendee_seats" class="error" style="font-size: 12px; color: #f35958; display: block;">There are only '+a+" seats left.</label>";$(i).insertAfter($(this))}else $(this).css("border",""),$("label.error").remove()})});